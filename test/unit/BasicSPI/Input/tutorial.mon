using com.apamax.rpi.spi.SPI;

monitor BasicSPI {
	/** @private */
	SPI SPIPlugin;
	
	action onload() {
		log "OnLoad reached!";
		SPIPlugin := (new SPI);
		boolean result := SPIPlugin.init(0, 500000);

		if(not result) {
			log "Failed to setup";
			die;
		}
		else {
			log "Setup succeeded";
		}

		integer i := 0;
		while(i < 10)
		{
			SPIPlugin.write(1);
			log "Writing 1 to SPI";
			SPIPlugin.delay(2000);
			SPIPlugin.write(0);
			log "Writing 0 to SPI";
			SPIPlugin.delay(2000);

			i := i + 1;
		}
	}
}
